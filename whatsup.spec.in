Name:    @PROJECT@
Version: @VERSION@
Release: @RELEASE@
Summary: whatsup node up/down detection utility
Group: Applications/Communications
License: GPL
Source: %{name}-%{version}-%{release}.tgz
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}

%description
Whatsup is a cluster node up/down detection utility.

%package genders
Summary: whatsup genders modules package
Group: System Environment/Base
Requires: whatsup
Requires: genders >= 1.2
%description genders
Genders modules packages.

%package gendersllnl
Summary: whatsup gendersllnl modules package
Group: System Environment/Base
Requires: whatsup
Requires: gendersllnl
%description gendersllnl
Gendersllnl modules packages.

%prep
%setup -q -n %{name}-%{version}-%{release}

%build
%configure --program-prefix=%{?_program_prefix:%{_program_prefix}} \
           --with-perl-install-destdir="$RPM_BUILD_ROOT" \
           %{_with_genders} \
           %{_without_genders} \
           %{_with_gendersllnl} \
           %{_without_gendersllnl}
make

%install
rm -rf "$RPM_BUILD_ROOT"
DESTDIR="$RPM_BUILD_ROOT" make install

%clean
rm -rf "$RPM_BUILD_ROOT"

%files
%defattr(-,root,root,0755)
%doc AUTHORS COPYING ChangeLog DISCLAIMER INSTALL NEWS README README.expat 
%doc README.hostsfile_install README.genders_install README.troubleshooting
# It doesn't matter if the user chooses a 32bit or 64bit target.  The
# packaging must work off whatever Perl is installed.
%define _perldir %(perl -e 'use Config; $T=$Config{installsitearch}; $T=~/(.*)\\/site_perl.*/; print $1;')
%{_bindir}/whatsup
%{_includedir}/*
%{_libdir}/libnodeupdown.*
%{_perldir}/*
%{_mandir}/*

%files genders
%defattr(-,root,root)
%{_libdir}/nodeupdown/*genders.*

%files gendersllnl
%defattr(-,root,root)
%{_libdir}/nodeupdown/*gendersllnl.*
%{_libdir}/whatsup/*gendersllnl.*

